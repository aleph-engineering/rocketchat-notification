language: go

services:
  - docker

script:
  - docker build -t alephdeveloper/rocketchat-notification:${TRAVIS_BUILD_NUMBER} .
  - docker tag alephdeveloper/rocketchat-notification:${TRAVIS_BUILD_NUMBER} alephdeveloper/rocketchat-notification:latest
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
  - docker push alephdeveloper/rocketchat-notification:${TRAVIS_BUILD_NUMBER}
  - docker push alephdeveloper/rocketchat-notification:latest
  - id=$(docker create alephdeveloper/rocketchat-notification:${TRAVIS_BUILD_NUMBER})
  - docker cp ${id}:/usr/bin/rocketchat-notification - > rocketchat-notification
  - docker rm -v ${id}
